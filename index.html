<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Pixels Aléatoires Infinis</title>
  <style>
    html, body {
      margin: 0;
      overflow: hidden;
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
<canvas id="canvas"></canvas>
<script>
  const canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");
  let width = window.innerWidth;
  let height = window.innerHeight;
  canvas.width = width;
  canvas.height = height;

  let zoom = 1;
  let offsetX = 0;
  let offsetY = 0;

  // Hash function pour générer un "hasard déterministe"
  function pseudoRandom(x, y) {
    let seed = (x * 374761393 + y * 668265263) ^ (x * y);
    seed = (seed ^ (seed >> 13)) * 1274126177;
    seed = (seed ^ (seed >> 16));
    return (seed >>> 0) / 4294967295; // entre 0 et 1
  }

  function getColor(x, y) {
    const h = Math.floor(pseudoRandom(x, y) * 360);
    const s = Math.floor(pseudoRandom(x + 13, y + 17) * 100);
    const l = Math.floor(pseudoRandom(x - 9, y + 22) * 100);
    return `hsl(${h}, ${s}%, ${l}%)`;
  }

  function draw() {
    const imageData = ctx.createImageData(width, height);
    const data = imageData.data;
    const pixelSize = 1 / zoom;

    for (let y = 0; y < height; y++) {
      for (let x = 0; x < width; x++) {
        const worldX = Math.floor((x - width / 2) * pixelSize + offsetX);
        const worldY = Math.floor((y - height / 2) * pixelSize + offsetY);
        const h = Math.floor(pseudoRandom(worldX, worldY) * 360);
        const s = pseudoRandom(worldX + 111, worldY + 91);
        const l = pseudoRandom(worldX - 78, worldY + 42);
        const color = hslToRgb(h, s, l);

        const index = (y * width + x) * 4;
        data[index] = color[0];
        data[index + 1] = color[1];
        data[index + 2] = color[2];
        data[index + 3] = 255;
      }
    }

    ctx.putImageData(imageData, 0, 0);
  }

  function hslToRgb(h, s, l) {
    h = h / 360;
    s = s;
    l = l;

    let r, g, b;

    if (s === 0) {
      r = g = b = l;
    } else {
      const hue2rgb = (p, q, t) => {
        if (t < 0) t += 1;
        if (t > 1) t -= 1;
        if (t < 1/6) return p + (q - p) * 6 * t;
        if (t < 1/2) return q;
        if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
        return p;
      };
      const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
      const p = 2 * l - q;
      r = hue2rgb(p, q, h + 1/3);
      g = hue2rgb(p, q, h);
      b = hue2rgb(p, q, h - 1/3);
    }

    return [Math.floor(r * 255), Math.floor(g * 255), Math.floor(b * 255)];
  }

  window.addEventListener("resize", () => {
    width = window.innerWidth;
    height = window.innerHeight;
    canvas.width = width;
    canvas.height = height;
    draw();
  });

  canvas.addEventListener("wheel", (e) => {
    const zoomFactor = 1.1;
    const mx = e.offsetX - width / 2;
    const my = e.offsetY - height / 2;
    const wx = offsetX + mx / zoom;
    const wy = offsetY + my / zoom;

    if (e.deltaY < 0) {
      zoom *= zoomFactor;
    } else {
      zoom /= zoomFactor;
    }

    offsetX = wx - mx / zoom;
    offsetY = wy - my / zoom;

    draw();
  });

  draw();
</script>
</body>
</html>
